A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     1


MACRO ASSEMBLER A51 V6.14
OBJECT MODULE PLACED IN .\proyecto.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE .\proyecto.a SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;VARIABLES GLOBALES
  0020                 2     ESTADO EQU 0x20
  0021                 3     EVENTO EQU 0x21
  0022                 4     VALOR_DISPLAY EQU 0x22
  0023                 5     T_CONT1 EQU 0x23
  0024                 6     T_CONT2 EQU 0x24
  0028                 7     TICK EQU 0x25.0
  0029                 8     PARPADEO EQU 0x25.1
  002A                 9     FADC EQU 0X25.2
  0026                10     CONT_ZUMB EQU 0x26
  0027                11     CONT_PARPADEO EQU 0x27  
                      12     
                      13     ;PCON EQU 0x87
  00C5                14     ADCON EQU 0xC5
  00FE                15     ADCH EQU 0xFE
  00FE                16     PWMP EQU 0xFE
  00FC                17     PWM0 EQU 0xFC
  00A8                18     IEN0 EQU 0xA8
                      19     
                      20     ;PUERTOS
  00A0                21     LED EQU P2.0
  00A1                22     ZUMBADOR EQU P2.1
  00B0                23     PLUS EQU P3.0
  00B1                24     MINUS EQU P3.1
  00B2                25     SWITCH EQU P3.2
  00B5                26     SENSOR EQU P3.5
                      27     
                      28     ;VARIABLES DE ESTADOS
                      29             ;1
  002A                30     ES1_CONT_MS EQU 0x2A
  002B                31     ES1_CONT_S EQU 0x2B
                      32             ;2
  002C                33     ES2_CONT_MS EQU 0x2C
  002D                34     ES2_CONT1_S EQU 0x2D
  002E                35     ES2_CONT2_S EQU 0x2E
                      36     
                      37     ;=======================INICIO====================
0000                  38     ORG 0X0000
0000 017B             39             AJMP INICIO
                      40     
007B                  41     ORG 0x007b
007B                  42     INICIO:
007B 1190             43             ACALL INIT
007D                  44     MAIN:
007D 1181             45             ACALL FSM
007F 017D             46             AJMP MAIN
0081                  47     FSM:
0081 E520             48             MOV A, ESTADO
0083 23               49             RL A
0084 900088           50             MOV DPTR, #EST_TAB
0087 73               51             JMP @A+DPTR
0088                  52     EST_TAB:
0088 01E2             53             AJMP ESTADO0            ;REPOSO
008A 210F             54             AJMP ESTADO1            ;ESPERA
008C 218C             55             AJMP ESTADO2            ;CALENTAR
008E 412E             56             AJMP ESTADO3            ;TRANSICION
                      57     ;========================INIT=====================;
0090                  58     INIT:
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     2

                      59             ;JUST DEBUGGING!!!!!!!!
                      60                     ;MOV P0, #0
                      61                     ;MOV P2, #0
0090 75B000           62                     MOV P3, #0
                      63                     ;ACALL ENCENDER_TIMER
0093 1106             64                     ACALL ENCENDER_ADC
                      65     
                      66             ;VALORES INICIALES
0095 752000           67             MOV ESTADO, #0
0098 752100           68             MOV EVENTO, #0
009B 752200           69             MOV VALOR_DISPLAY, #0
009E 752300           70             MOV T_CONT1, #0
00A1 752400           71             MOV T_CONT2, #0
00A4 752600           72             MOV CONT_ZUMB, #0
00A7 752700           73             MOV CONT_PARPADEO, #0
00AA C229             74             CLR PARPADEO
                      75     
                      76             ;PUERTOS ENTRADA
00AC D2B0             77             SETB PLUS
00AE D2B1             78             SETB MINUS
00B0 D2B2             79             SETB SWITCH
00B2 D2B5             80             SETB SENSOR
                      81     
                      82             ;PUERTOS SALIDA
00B4 C280             83             CLR P0.0
00B6 C281             84             CLR P0.1
00B8 C282             85             CLR P0.2
00BA C283             86             CLR P0.3
00BC C284             87             CLR P0.4
00BE C285             88             CLR P0.5
00C0 C286             89             CLR P0.6
00C2 C287             90             CLR P0.7
00C4 C2A0             91             CLR LED
00C6 C2A1             92             CLR ZUMBADOR
00C8 D2A1             93             SETB ZUMBADOR
                      94     
                      95             ;TIMER
00CA 438902           96             ORL TMOD, #00000010b
00CD 5389F2           97             ANL TMOD, #11110010b
00D0 C228             98             CLR TICK
                      99     
                     100             ;VARIABLES DE ESTADOS
                     101                     ;1
00D2 752A00          102             MOV ES1_CONT_MS, #0
00D5 752B00          103             MOV ES1_CONT_S, #0
                     104                     ;2
00D8 752C00          105             MOV ES2_CONT_MS, #0
00DB 752D00          106             MOV ES2_CONT1_S, #0
00DE 752E00          107             MOV ES2_CONT2_S, #0
                     108     
00E1 22              109             RET
                     110     ;===================ESTADO0_REPOSO================;
00E2                 111     ESTADO0:
00E2 3106            112             ACALL ES0_GEN_EV
00E4 E521            113             MOV A, EVENTO
00E6 23              114             RL A
00E7 9000EB          115             MOV DPTR, #ES0_EV_TAB
00EA 73              116             JMP @A+DPTR
00EB                 117     ES0_EV_TAB:
00EB 01EF            118             AJMP ES0_EV0                    ;EVENTO VACIO
00ED 01F2            119             AJMP ES0_EV1                    ;ENCENDIDO
00EF                 120     ES0_EV0:                        ;EVENTO VACIO
00EF 6140            121             AJMP ACTIVAR_IDL
00F1 22              122             RET
00F2                 123     ES0_EV1:                        ;EVENTO ESPERA
                     124             ;PONER UN 0 EN PANTALLA
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     3

00F2 752200          125             MOV VALOR_DISPLAY, #0
00F5 51AC            126             ACALL UPDATE_DISPLAY
00F7 517E            127             ACALL ENCENDER_PARPADEO
                     128             ;LED ON
00F9 5170            129             ACALL ENCENDER_LED
                     130             ;ZUMBIDO ON - (SE APAGARA EN 200MS)
00FB 7125            131             ACALL ENCENDER_ZUMBADOR
                     132             ;ENCENDER TIMER
00FD 1156            133             ACALL ENCENDER_TIMER
                     134             ;CAMBIAR AL ESTADO 1
00FF 752001          135             MOV ESTADO, #1
                     136             ;CAMBIAR EL EVENTO AL 0
0102 752100          137             MOV EVENTO, #0
0105 22              138             RET
0106                 139     ES0_GEN_EV:
                     140             ;COMPROBAR SI SE HA PULSADO EL BOTON
0106 A2B2            141             MOV C, SWITCH
0108 5001            142             JNC ES0_SWITCH
010A 22              143             RET
010B                 144     ES0_SWITCH:
010B 752101          145             MOV EVENTO, #1
010E 22              146             RET
                     147     ;====================ESTADO1_ESPERA================
010F                 148     ESTADO1:
010F 3157            149             ACALL ES1_GEN_EV
0111 E521            150             MOV A, EVENTO
0113 23              151             RL A
0114 900118          152             MOV DPTR, #ES1_EV_TAB
0117 73              153             JMP @A+DPTR
0118                 154     ES1_EV_TAB:
0118 211E            155             AJMP ES1_EV0
011A 211F            156             AJMP ES1_EV1
011C 213C            157             AJMP ES1_EV2
011E                 158     ES1_EV0:                        ;EVENTO VACIO
011E 22              159             RET
011F                 160     ES1_EV1:                        ;EVENTO REPOSO
                     161             ;RESETEAR VARIABLES DE ESTADO
011F 752A00          162             MOV ES1_CONT_MS, #0
0122 752B00          163             MOV ES1_CONT_S, #0
0125 752600          164             MOV CONT_ZUMB, #0
0128 752700          165             MOV CONT_PARPADEO, #0
                     166             ;
012B 51A5            167             ACALL APAGAR_DISPLAY
012D 5184            168             ACALL APAGAR_PARPADEO
012F 712B            169             ACALL APAGAR_ZUMBADOR
0131 5173            170             ACALL APAGAR_LED
0133 1168            171             ACALL APAGAR_TIMER
                     172     
0135 752000          173             MOV ESTADO, #0
0138 752100          174             MOV EVENTO, #0
013B 22              175             RET
013C                 176     ES1_EV2:                        ;EVENTO CALENTAR
                     177             ;RESETEAR VARIABLES DE ESTADO
013C 752A00          178             MOV ES1_CONT_MS, #0
013F 752B00          179             MOV ES1_CONT_S, #0
0142 752600          180             MOV CONT_ZUMB, #0
0145 752700          181             MOV CONT_PARPADEO, #0
                     182             ;
0148 5184            183             ACALL APAGAR_PARPADEO
014A 51A9            184             ACALL ENCENDER_DISPLAY
014C 712B            185             ACALL APAGAR_ZUMBADOR
                     186             ;ENCENDER PWM
014E 5176            187             ACALL ENCENDER_PWM
                     188     
0150 752002          189             MOV ESTADO, #2
0153 752100          190             MOV EVENTO, #0
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     4

0156 22              191             RET     
0157                 192     ES1_GEN_EV:
                     193             ;COMPROBAR SI SE HA PULSADO EL SWITCH
0157 A2B2            194             MOV C, SWITCH
0159 5009            195             JNC ES1_SWITCH
                     196             ;COMPROBAR SI SE HA COLOCADO RECIPIENTE
015B A2B5            197             MOV C, SENSOR
015D 4009            198             JC ES1_SENSOR
                     199             ;COMPROBAR SI HA PASADO 100MS
015F A228            200             MOV C, TICK
0161 4009            201             JC ES1_TICK
0163 22              202             RET
0164                 203     ES1_SWITCH:                     ;SE DETECTA ON/OFF
0164 752101          204             MOV EVENTO, #1
0167 22              205             RET
0168                 206     ES1_SENSOR:                     ;SE DETECTA RECIPIENTE
0168 752102          207             MOV EVENTO, #2
016B 22              208             RET
016C                 209     ES1_TICK:                       ;PASA 100MS SIN RECIPIENTE
016C C228            210             CLR TICK
016E 052A            211             INC ES1_CONT_MS
0170 740A            212             MOV A, #10
0172 C3              213             CLR C
0173 952A            214             SUBB A, ES1_CONT_MS
0175 6001            215             JZ ES1_1S
0177 22              216             RET
0178                 217     ES1_1S:                         ;PASA 1S SIN RECIPIENTE
0178 752A00          218             MOV ES1_CONT_MS, #0
017B 052B            219             INC ES1_CONT_S
017D 740F            220             MOV A, #15
017F C3              221             CLR C
0180 952B            222             SUBB A, ES1_CONT_S
0182 6001            223             JZ ES1_15S
0184 22              224             RET
0185                 225     ES1_15S:                        ;PASA 15S SIN RECIPIENTE
0185 752B00          226             MOV ES1_CONT_S, #0
0188 752101          227             MOV EVENTO, #1
018B 22              228             RET
                     229     ;===================ESTADO2_CALENTAR===============
018C                 230     ESTADO2:
018C 31C3            231             ACALL ES2_GEN_EV
018E E521            232             MOV A, EVENTO
0190 23              233             RL A
0191 900195          234             MOV DPTR, #ES2_EV_TAB
0194 73              235             JMP @A+DPTR
0195                 236     ES2_EV_TAB:
0195 219D            237             AJMP ES2_EV0
0197 219E            238             AJMP ES2_EV1
0199 21AB            239             AJMP ES2_EV2
019B 21B7            240             AJMP ES2_EV3
019D                 241     ES2_EV0:                        ;EVENTO VACIO
019D 22              242             RET
019E                 243     ES2_EV1:                        ;EVENTO TRANSICION
                     244             ;ENCENDER ZUMBADOR
019E 7125            245             ACALL ENCENDER_ZUMBADOR
                     246             ;APAGAR LED
01A0 5173            247             ACALL APAGAR_LED
                     248             ;ENCENDER ADC
01A2 1106            249             ACALL ENCENDER_ADC
                     250     
01A4 752003          251             MOV ESTADO, #3
01A7 752100          252             MOV EVENTO, #0          
01AA 22              253             RET
01AB                 254     ES2_EV2:
01AB 7400            255             MOV A, #0
01AD C3              256             CLR C
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     5

01AE 9522            257             SUBB A, VALOR_DISPLAY
01B0 6075            258             JZ ES2_NOTHING
01B2 1522            259             DEC VALOR_DISPLAY
01B4 51AC            260             ACALL UPDATE_DISPLAY
01B6 22              261             RET
01B7                 262     ES2_EV3:
01B7 740A            263             MOV A, #10
01B9 C3              264             CLR C
01BA 9522            265             SUBB A, VALOR_DISPLAY
01BC 6069            266             JZ ES2_NOTHING
01BE 0522            267             INC VALOR_DISPLAY
01C0 51AC            268             ACALL UPDATE_DISPLAY
01C2 22              269             RET
01C3                 270     ES2_GEN_EV:
                     271             ;SE HA PULSADO EL BOTON ON/OFF
01C3 A2B2            272             MOV C, SWITCH
01C5 500D            273             JNC ES2_SWITCH
                     274             ;SE HA PULSADO EL BOTON DE MENOS
01C7 A2B1            275             MOV C, MINUS
01C9 400D            276             JC ES2_MINUS
                     277             ;SE HA PULSADO EL BOTON DE MAS
01CB A2B0            278             MOV C, PLUS
01CD 400C            279             JC ES2_PLUS
                     280             ;PASA 100MS SIN RECIPIENTE
01CF A228            281             MOV C, TICK
01D1 400B            282             JC ES2_TICK
01D3 22              283             RET
01D4                 284     ES2_SWITCH:
01D4 752101          285             MOV EVENTO, #1
01D7 22              286             RET
01D8                 287     ES2_MINUS:
01D8 752102          288             MOV EVENTO, #2
01DB                 289     ES2_PLUS:
01DB 752103          290             MOV EVENTO, #3
01DE                 291     ES2_TICK:
01DE C228            292             CLR TICK
01E0 052C            293             INC ES2_CONT_MS
01E2 740A            294             MOV A, #10
01E4 C3              295             CLR C
01E5 952C            296             SUBB A, ES2_CONT_MS
01E7 6001            297             JZ ES2_1S
01E9 22              298             RET
01EA                 299     ES2_1S:
01EA 752C00          300             MOV ES2_CONT_MS, #0
01ED 5103            301             ACALL ES2_SENSOR
01EF 22              302             RET
01F0                 303     ES2_30S:
01F0 752D00          304             MOV ES2_CONT1_S, #0
01F3 752E00          305             MOV ES2_CONT2_S, #0
01F6 752101          306             MOV EVENTO, #1
01F9 22              307             RET
01FA                 308     ES2_60S:
01FA 752D00          309             MOV ES2_CONT1_S, #0
01FD 752E00          310             MOV ES2_CONT2_S, #0
0200 752101          311             MOV EVENTO, #1
0203                 312     ES2_SENSOR:
0203 A2B5            313             MOV C, SENSOR
0205 4002            314             JC ES2_SENSOR_ON
0207 5011            315             JNC ES2_SENSOR_OFF
0209                 316     ES2_SENSOR_ON:
0209 E522            317             MOV A, VALOR_DISPLAY
020B 701A            318             JNZ ES2_NOTHING
020D 752D00          319             MOV ES2_CONT1_S, #0
0210 052E            320             INC ES2_CONT2_S
0212 743C            321             MOV A, #60
0214 C3              322             CLR C
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     6

0215 952E            323             SUBB A, ES2_CONT2_S
0217 60E1            324             JZ ES2_60S
0219 22              325             RET
021A                 326     ES2_SENSOR_OFF:
021A 752E00          327             MOV ES2_CONT2_S, #0
021D 052D            328             INC ES2_CONT1_S
021F 741E            329             MOV A, #30
0221 C3              330             CLR C
0222 952D            331             SUBB A, ES2_CONT1_S
0224 60CA            332             JZ ES2_30S
0226 22              333             RET
0227                 334     ES2_NOTHING:
0227 752D00          335             MOV ES2_CONT1_S, #0
022A 752D00          336             MOV ES2_CONT1_S, #0
022D 22              337             RET
                     338     ;==================ESTADO3_TRANSICION==============
022E                 339     ESTADO3:
022E 5145            340             ACALL ES3_GEN_EV
0230 E521            341             MOV A, EVENTO
0232 23              342             RL A
0233 900237          343             MOV DPTR, #ES3_EV_TAB
0236 73              344             JMP @A+DPTR
0237                 345     ES3_EV_TAB:
0237 413B            346             AJMP ES3_EV0
0239 413C            347             AJMP ES3_EV1
023B                 348     ES3_EV0:                        ;EVENTO VACIO
023B 22              349             RET
023C                 350     ES3_EV1:                        ;EVENTO ESPERA
023C 712B            351             ACALL APAGAR_ZUMBADOR
023E 752000          352             MOV ESTADO, #0
0241 752100          353             MOV EVENTO, #0
0244 22              354             RET
0245                 355     ES3_GEN_EV:
0245 A22A            356             MOV C, FADC
0247 4001            357             JC ES3_ADC
0249 22              358             RET
024A                 359     ES3_ADC:
024A 1114            360             ACALL LEER_ADC          ;AHORA TENGO EN B EL VALOR DEL ADC
                     361             
                     362             ;MENOS DE 40
024C E5F0            363             MOV A, B
024E C3              364             CLR C
024F 9428            365             SUBB A, #40
0251 4009            366             JC ES3_40
                     367             ;MAS DE 80
0253 E5F0            368             MOV A, B
0255 C3              369             CLR C
0256 9450            370             SUBB A, #80
0258 500E            371             JNC ES3_80
                     372             ;ENTRE 40 Y 80
025A 4160            373             AJMP ES3_60
025C                 374     ES3_40:
025C 752101          375             MOV EVENTO, #1
025F 22              376             RET
0260                 377     ES3_60:
0260 75220B          378             MOV VALOR_DISPLAY, #11
0263 51AC            379             ACALL UPDATE_DISPLAY
0265 1106            380             ACALL ENCENDER_ADC
0267 22              381             RET
0268                 382     ES3_80:
0268 75220C          383             MOV VALOR_DISPLAY, #12
026B 51AC            384             ACALL UPDATE_DISPLAY
026D 1106            385             ACALL ENCENDER_ADC
026F 22              386             RET
                     387     
                     388     ;=========================LED======================
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     7

0270                 389     ENCENDER_LED:   
0270 D2A0            390             SETB LED
0272 22              391             RET
0273                 392     APAGAR_LED:
0273 C2A0            393             CLR LED
0275 22              394             RET
                     395     ;=========================PWM======================
0276                 396     ENCENDER_PWM:
0276 75FE01          397             MOV PWMP, #1
0279 22              398             RET
027A                 399     APAGAR_PWM:
027A 75FE00          400             MOV PWMP, #0
027D 22              401             RET
                     402     ;=======================DISPLAY====================
027E                 403     ENCENDER_PARPADEO:
027E 752700          404             MOV CONT_PARPADEO, #0
0281 D229            405             SETB PARPADEO
0283 22              406             RET
0284                 407     APAGAR_PARPADEO:
0284 752700          408             MOV CONT_PARPADEO, #0
0287 C229            409             CLR PARPADEO
0289 22              410             RET
028A                 411     ESTADO_PARPADEO:
028A A229            412             MOV C, PARPADEO
028C 4001            413             JC PARPADEO_500MS
028E 22              414             RET
028F                 415     PARPADEO_500MS:
                     416             ;HAN PASADO 500MS?
028F 0527            417             INC CONT_PARPADEO
0291 7405            418             MOV A, #5
0293 C3              419             CLR C
0294 9527            420             SUBB A, CONT_PARPADEO
0296 6001            421             JZ UPDATE_PARPADEO
0298 22              422             RET
0299                 423     UPDATE_PARPADEO:
0299 752700          424             MOV CONT_PARPADEO, #0
029C E580            425             MOV A, P0
029E 547F            426             ANL A, #01111111b
02A0 7003            427             JNZ APAGAR_DISPLAY
02A2 6005            428             JZ ENCENDER_DISPLAY
02A4 22              429             RET
02A5                 430     APAGAR_DISPLAY:
02A5 538000          431             ANL P0, #0000000b
02A8 22              432             RET
02A9                 433     ENCENDER_DISPLAY:
02A9 51AC            434             ACALL UPDATE_DISPLAY
02AB 22              435             RET
02AC                 436     UPDATE_DISPLAY:
02AC 538000          437             ANL P0, #00000000b
02AF E522            438             MOV A, VALOR_DISPLAY
02B1 23              439             RL A
02B2 9002B6          440             MOV DPTR, #DISPLAY_FUNC
02B5 73              441             JMP @A+DPTR
02B6                 442     DISPLAY_FUNC:
02B6 41D0            443             AJMP DISPLAY_0  ;0
02B8 41D7            444             AJMP DISPLAY_1  ;1
02BA 41DE            445             AJMP DISPLAY_2  ;2
02BC 41E5            446             AJMP DISPLAY_3  ;3
02BE 41EC            447             AJMP DISPLAY_4  ;4
02C0 41F3            448             AJMP DISPLAY_5  ;5
02C2 41FA            449             AJMP DISPLAY_6  ;6
02C4 6101            450             AJMP DISPLAY_7  ;7
02C6 6108            451             AJMP DISPLAY_8  ;8
02C8 610F            452             AJMP DISPLAY_9  ;9
02CA 6116            453             AJMP DISPLAY_P  ;10
02CC 611D            454             AJMP DISPLAY_H  ;11
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     8

02CE 6121            455             AJMP DISPLAY_HH ;12
02D0                 456     DISPLAY_0:      ;*gfedcba
02D0 43803F          457             ORL P0, #00111111b
02D3 75FCFF          458             MOV PWM0, #255          ;0%
02D6 22              459             RET
02D7                 460     DISPLAY_1:
02D7 438006          461             ORL P0, #00000110b
02DA 75FCE6          462             MOV PWM0, #230          ;10%
02DD 22              463             RET
02DE                 464     DISPLAY_2:
02DE 43805B          465             ORL P0, #01011011b
02E1 75FCCC          466             MOV PWM0, #204          ;20%
02E4 22              467             RET
02E5                 468     DISPLAY_3:
02E5 43804F          469             ORL P0, #01001111b
02E8 75FCB2          470             MOV PWM0, #178          ;30%
02EB 22              471             RET
02EC                 472     DISPLAY_4:
02EC 43807F          473             ORL P0, #01111111b
02EF 75FC99          474             MOV PWM0, #153          ;40%
02F2 22              475             RET
02F3                 476     DISPLAY_5:
02F3 43806D          477             ORL P0, #01101101b
02F6 857FFC          478             MOV PWM0, 127           ;50%
02F9 22              479             RET
02FA                 480     DISPLAY_6:
02FA 43807D          481             ORL P0, #01111101b
02FD 75FC66          482             MOV PWM0, #102          ;60%
0300 22              483             RET
0301                 484     DISPLAY_7:
0301 43800F          485             ORL P0, #00001111b
0304 75FC4E          486             MOV PWM0, #78           ;70%
0307 22              487             RET
0308                 488     DISPLAY_8:
0308 43807F          489             ORL P0, #01111111b
030B 75FC34          490             MOV PWM0, #52           ;80%
030E 22              491             RET
030F                 492     DISPLAY_9:
030F 43806F          493             ORL P0, #01101111b
0312 75FC1A          494             MOV PWM0, #26           ;90%
0315 22              495             RET
0316                 496     DISPLAY_P:
0316 438073          497             ORL P0, #01110011b
0319 75FC00          498             MOV PWM0, #0            ;100%
031C 22              499             RET
031D                 500     DISPLAY_H:
031D 438074          501             ORL P0, #01110100b
0320 22              502             RET
0321                 503     DISPLAY_HH:
0321 438076          504             ORL P0, #01110110b
0324 22              505             RET
                     506     ;======================ZUMBADOR====================
0325                 507     ENCENDER_ZUMBADOR:
0325 752600          508             MOV CONT_ZUMB, #0
0328 C2A1            509             CLR ZUMBADOR
032A 22              510             RET
032B                 511     APAGAR_ZUMBADOR:
032B 752600          512             MOV CONT_ZUMB, #0
032E D2A1            513             SETB ZUMBADOR
0330 22              514             RET
0331                 515     ZUMBADOR_ESTADO:
                     516             ;ESTA EL ZUMBADOR ENCENDIDO?
0331 A2A1            517             MOV C, ZUMBADOR
0333 5001            518             JNC ZUMBADOR_200MS
0335 22              519             RET
0336                 520     ZUMBADOR_200MS:
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE     9

0336 0526            521             INC CONT_ZUMB
0338 7402            522             MOV A, #2
033A C3              523             CLR C
033B 9526            524             SUBB A, CONT_ZUMB
033D 60EC            525             JZ APAGAR_ZUMBADOR
033F 22              526             RET
                     527     ;===================PCON + External===============
0340                 528     ACTIVAR_IDL:
0340 43A881          529             ORL IEN0, #10000001b
0343 438701          530             ORL PCON, #00000001b 
0346 22              531             RET     
0347                 532     DESACTIVAR_IDL:
0347 53A800          533             ANL IEN0, #00000000b
034A 538700          534             ANL PCON, #00000000b
034D 22              535             RET
0003                 536     ORG 0x03
0003                 537     INTERRUPCION_EXTERNA:
0003 7147            538             ACALL DESACTIVAR_IDL
0005 32              539             RETI
                     540     ;=========================ADC======================
0006                 541     ENCENDER_ADC:
0006 43A8C0          542             ORL IEN0,#11000000b
0009 53C5F9          543             ANL ADCON, #11111001b
000C 43C509          544             ORL ADCON, #00001001b
000F 22              545             RET     
0010                 546     APAGAR_ADC:
0010 53A800          547             ANL IEN0, #00000000b
0013 22              548             RET
0014                 549     LEER_ADC:
0014 C22A            550             CLR FADC
0016 85FEF0          551             MOV B, ADCH
0019 22              552             RET
0053                 553     ORG 0x53
0053                 554     INTERRUPCION_ADC:       
0053 D22A            555             SETB FADC
0055 32              556             RETI
                     557     ;========================TIMER=====================
0056                 558     ENCENDER_TIMER:
0056 43A882          559             ORL IEN0, #10000010b
0059 758C06          560             MOV TH0, #6
005C 758A06          561             MOV TL0, #6
005F 752300          562             MOV T_CONT1, #0
0062 752400          563             MOV T_CONT2, #0
0065 D28C            564             SETB TR0
0067 22              565             RET
0068                 566     APAGAR_TIMER:
0068 53A800          567             ANL IEN0, #00000000b
006B C28C            568             CLR TR0
006D 22              569             RET
000B                 570     ORG 0x0B
000B                 571     INTERRUPCION_TIMER:
000B 110E            572             ACALL TIMER_FUNC
000D 32              573             RETI
                     574     
000E                 575     TIMER_FUNC:
000E C0D0            576             PUSH PSW
0010 C0E0            577             PUSH ACC
                     578     
0012 0523            579             INC T_CONT1
0014 747F            580             MOV A, #127
0016 C3              581             CLR C
0017 9523            582             SUBB A, T_CONT1
0019 701A            583             JNZ CONDTIMER
                     584     
001B 752300          585             MOV T_CONT1, #0
001E 0524            586             INC T_CONT2
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE    10

0020 7464            587             MOV A, #100
0022 C3              588             CLR C
0023 9524            589             SUBB A, T_CONT2
0025 700E            590             JNZ CONDTIMER
                     591     
0027 752400          592             MOV T_CONT2, #0
002A D228            593             SETB TICK                       ;HA PASADO 100ms!
                     594     
002C 7131            595             ACALL ZUMBADOR_ESTADO
002E 518A            596             ACALL ESTADO_PARPADEO
                     597     
0030 D0E0            598             POP ACC
0032 D0D0            599             POP PSW
0034 22              600             RET
0035                 601     CONDTIMER:
0035 D0E0            602             POP ACC
0037 D0D0            603             POP PSW
0039 22              604             RET
                     605     ;========================END======================
                     606     END
                             
                             ;HA FECHA 13/10/2022 SOLO YO Y DIOS SABIAMOS LO QUE AQUI HABIA ESCRITO.
                             ;CUENDO ESTES LEYENDO ESTO, SEGURAMENTE, SOLO DIOS LO SEPA.
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE    11

SYMBOL TABLE LISTING
------ ----- -------


N A M E               T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . . .  D ADDR   00E0H   A   
ACTIVAR_IDL. . . . .  C ADDR   0340H   A   
ADCH . . . . . . . .  N NUMB   00FEH   A   
ADCON. . . . . . . .  N NUMB   00C5H   A   
APAGAR_ADC . . . . .  C ADDR   0010H   A   
APAGAR_DISPLAY . . .  C ADDR   02A5H   A   
APAGAR_LED . . . . .  C ADDR   0273H   A   
APAGAR_PARPADEO. . .  C ADDR   0284H   A   
APAGAR_PWM . . . . .  C ADDR   027AH   A   
APAGAR_TIMER . . . .  C ADDR   0068H   A   
APAGAR_ZUMBADOR. . .  C ADDR   032BH   A   
B. . . . . . . . . .  D ADDR   00F0H   A   
CONDTIMER. . . . . .  C ADDR   0035H   A   
CONT_PARPADEO. . . .  N NUMB   0027H   A   
CONT_ZUMB. . . . . .  N NUMB   0026H   A   
DESACTIVAR_IDL . . .  C ADDR   0347H   A   
DISPLAY_0. . . . . .  C ADDR   02D0H   A   
DISPLAY_1. . . . . .  C ADDR   02D7H   A   
DISPLAY_2. . . . . .  C ADDR   02DEH   A   
DISPLAY_3. . . . . .  C ADDR   02E5H   A   
DISPLAY_4. . . . . .  C ADDR   02ECH   A   
DISPLAY_5. . . . . .  C ADDR   02F3H   A   
DISPLAY_6. . . . . .  C ADDR   02FAH   A   
DISPLAY_7. . . . . .  C ADDR   0301H   A   
DISPLAY_8. . . . . .  C ADDR   0308H   A   
DISPLAY_9. . . . . .  C ADDR   030FH   A   
DISPLAY_FUNC . . . .  C ADDR   02B6H   A   
DISPLAY_H. . . . . .  C ADDR   031DH   A   
DISPLAY_HH . . . . .  C ADDR   0321H   A   
DISPLAY_P. . . . . .  C ADDR   0316H   A   
ENCENDER_ADC . . . .  C ADDR   0006H   A   
ENCENDER_DISPLAY . .  C ADDR   02A9H   A   
ENCENDER_LED . . . .  C ADDR   0270H   A   
ENCENDER_PARPADEO. .  C ADDR   027EH   A   
ENCENDER_PWM . . . .  C ADDR   0276H   A   
ENCENDER_TIMER . . .  C ADDR   0056H   A   
ENCENDER_ZUMBADOR. .  C ADDR   0325H   A   
ES0_EV0. . . . . . .  C ADDR   00EFH   A   
ES0_EV1. . . . . . .  C ADDR   00F2H   A   
ES0_EV_TAB . . . . .  C ADDR   00EBH   A   
ES0_GEN_EV . . . . .  C ADDR   0106H   A   
ES0_SWITCH . . . . .  C ADDR   010BH   A   
ES1_15S. . . . . . .  C ADDR   0185H   A   
ES1_1S . . . . . . .  C ADDR   0178H   A   
ES1_CONT_MS. . . . .  N NUMB   002AH   A   
ES1_CONT_S . . . . .  N NUMB   002BH   A   
ES1_EV0. . . . . . .  C ADDR   011EH   A   
ES1_EV1. . . . . . .  C ADDR   011FH   A   
ES1_EV2. . . . . . .  C ADDR   013CH   A   
ES1_EV_TAB . . . . .  C ADDR   0118H   A   
ES1_GEN_EV . . . . .  C ADDR   0157H   A   
ES1_SENSOR . . . . .  C ADDR   0168H   A   
ES1_SWITCH . . . . .  C ADDR   0164H   A   
ES1_TICK . . . . . .  C ADDR   016CH   A   
ES2_1S . . . . . . .  C ADDR   01EAH   A   
ES2_30S. . . . . . .  C ADDR   01F0H   A   
ES2_60S. . . . . . .  C ADDR   01FAH   A   
ES2_CONT1_S. . . . .  N NUMB   002DH   A   
ES2_CONT2_S. . . . .  N NUMB   002EH   A   
ES2_CONT_MS. . . . .  N NUMB   002CH   A   
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE    12

ES2_EV0. . . . . . .  C ADDR   019DH   A   
ES2_EV1. . . . . . .  C ADDR   019EH   A   
ES2_EV2. . . . . . .  C ADDR   01ABH   A   
ES2_EV3. . . . . . .  C ADDR   01B7H   A   
ES2_EV_TAB . . . . .  C ADDR   0195H   A   
ES2_GEN_EV . . . . .  C ADDR   01C3H   A   
ES2_MINUS. . . . . .  C ADDR   01D8H   A   
ES2_NOTHING. . . . .  C ADDR   0227H   A   
ES2_PLUS . . . . . .  C ADDR   01DBH   A   
ES2_SENSOR . . . . .  C ADDR   0203H   A   
ES2_SENSOR_OFF . . .  C ADDR   021AH   A   
ES2_SENSOR_ON. . . .  C ADDR   0209H   A   
ES2_SWITCH . . . . .  C ADDR   01D4H   A   
ES2_TICK . . . . . .  C ADDR   01DEH   A   
ES3_40 . . . . . . .  C ADDR   025CH   A   
ES3_60 . . . . . . .  C ADDR   0260H   A   
ES3_80 . . . . . . .  C ADDR   0268H   A   
ES3_ADC. . . . . . .  C ADDR   024AH   A   
ES3_EV0. . . . . . .  C ADDR   023BH   A   
ES3_EV1. . . . . . .  C ADDR   023CH   A   
ES3_EV_TAB . . . . .  C ADDR   0237H   A   
ES3_GEN_EV . . . . .  C ADDR   0245H   A   
ESTADO . . . . . . .  N NUMB   0020H   A   
ESTADO0. . . . . . .  C ADDR   00E2H   A   
ESTADO1. . . . . . .  C ADDR   010FH   A   
ESTADO2. . . . . . .  C ADDR   018CH   A   
ESTADO3. . . . . . .  C ADDR   022EH   A   
ESTADO_PARPADEO. . .  C ADDR   028AH   A   
EST_TAB. . . . . . .  C ADDR   0088H   A   
EVENTO . . . . . . .  N NUMB   0021H   A   
FADC . . . . . . . .  B ADDR   0025H.2 A   
FSM. . . . . . . . .  C ADDR   0081H   A   
IEN0 . . . . . . . .  N NUMB   00A8H   A   
INICIO . . . . . . .  C ADDR   007BH   A   
INIT . . . . . . . .  C ADDR   0090H   A   
INTERRUPCION_ADC . .  C ADDR   0053H   A   
INTERRUPCION_EXTERNA  C ADDR   0003H   A   
INTERRUPCION_TIMER .  C ADDR   000BH   A   
LED. . . . . . . . .  B ADDR   00A0H.0 A   
LEER_ADC . . . . . .  C ADDR   0014H   A   
MAIN . . . . . . . .  C ADDR   007DH   A   
MINUS. . . . . . . .  B ADDR   00B0H.1 A   
P0 . . . . . . . . .  D ADDR   0080H   A   
P2 . . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . . .  D ADDR   00B0H   A   
PARPADEO . . . . . .  B ADDR   0025H.1 A   
PARPADEO_500MS . . .  C ADDR   028FH   A   
PCON . . . . . . . .  D ADDR   0087H   A   
PLUS . . . . . . . .  B ADDR   00B0H.0 A   
PSW. . . . . . . . .  D ADDR   00D0H   A   
PWM0 . . . . . . . .  N NUMB   00FCH   A   
PWMP . . . . . . . .  N NUMB   00FEH   A   
SENSOR . . . . . . .  B ADDR   00B0H.5 A   
SWITCH . . . . . . .  B ADDR   00B0H.2 A   
TH0. . . . . . . . .  D ADDR   008CH   A   
TICK . . . . . . . .  B ADDR   0025H.0 A   
TIMER_FUNC . . . . .  C ADDR   000EH   A   
TL0. . . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . . .  B ADDR   0088H.4 A   
T_CONT1. . . . . . .  N NUMB   0023H   A   
T_CONT2. . . . . . .  N NUMB   0024H   A   
UPDATE_DISPLAY . . .  C ADDR   02ACH   A   
UPDATE_PARPADEO. . .  C ADDR   0299H   A   
VALOR_DISPLAY. . . .  N NUMB   0022H   A   
ZUMBADOR . . . . . .  B ADDR   00A0H.1 A   
A51 MACRO ASSEMBLER  PROYECTO                                                             10/18/2022 14:44:51 PAGE    13

ZUMBADOR_200MS . . .  C ADDR   0336H   A   
ZUMBADOR_ESTADO. . .  C ADDR   0331H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
